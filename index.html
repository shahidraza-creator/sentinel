<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SENTINEL ‚Äî Cyber Defense Dashboard</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>"/>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet"/>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
  <style>
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
    :root{
      --navy:#080e1a;--card:rgba(15,25,45,0.85);
      --border:rgba(100,160,255,0.1);--border2:rgba(100,160,255,0.2);
      --blue:#4a9eff;--blue-soft:#2d7dd2;--blue-glow:rgba(74,158,255,0.15);
      --teal:#00d4aa;--teal-glow:rgba(0,212,170,0.12);
      --red:#ff4d6a;--red-glow:rgba(255,77,106,0.12);
      --amber:#ffb347;--amber-glow:rgba(255,179,71,0.12);
      --green:#4ade80;--green-glow:rgba(74,222,128,0.12);
      --text:#94a3b8;--text2:#cbd5e1;--white:#f0f6ff;--sidebar-w:240px;
    }
    html,body{height:100%;overflow:hidden}
    body{font-family:'Syne',sans-serif;background:var(--navy);color:var(--white);height:100vh;display:flex;overflow:hidden}
    .bg-mesh{position:fixed;inset:0;z-index:0;pointer-events:none;
      background:radial-gradient(ellipse 80% 50% at 20% 10%,rgba(29,78,216,0.12) 0%,transparent 60%),
      radial-gradient(ellipse 60% 40% at 80% 80%,rgba(0,212,170,0.07) 0%,transparent 55%)}
    .sidebar{width:var(--sidebar-w);height:100vh;background:rgba(8,14,26,0.95);border-right:1px solid var(--border);display:flex;flex-direction:column;flex-shrink:0;position:relative;z-index:10;backdrop-filter:blur(20px)}
    .sidebar-logo{padding:24px 20px 20px;border-bottom:1px solid var(--border)}
    .logo-mark{display:flex;align-items:center;gap:10px;margin-bottom:4px}
    .logo-icon{width:34px;height:34px;border-radius:8px;background:linear-gradient(135deg,#4a9eff,#00d4aa);display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;box-shadow:0 0 20px rgba(74,158,255,0.3)}
    .logo-name{font-size:17px;font-weight:800;letter-spacing:2px;background:linear-gradient(90deg,#4a9eff,#00d4aa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .logo-sub{font-size:10px;color:var(--text);letter-spacing:1px;font-family:'DM Mono',monospace}
    .sidebar-nav{padding:12px 10px;flex:1;overflow-y:auto}
    .nav-section-label{font-size:9px;letter-spacing:2px;color:var(--text);padding:8px 10px 4px;text-transform:uppercase;font-family:'DM Mono',monospace}
    .nav-item{display:flex;align-items:center;gap:10px;padding:9px 10px;border-radius:10px;cursor:pointer;margin-bottom:2px;transition:all 0.2s;border:1px solid transparent;font-size:12px;font-weight:500;color:var(--text);position:relative}
    .nav-item:hover{background:var(--blue-glow);color:var(--text2)}
    .nav-item.active{background:linear-gradient(135deg,rgba(74,158,255,0.15),rgba(0,212,170,0.08));border-color:var(--border2);color:var(--white)}
    .nav-item.active::before{content:'';position:absolute;left:0;top:50%;transform:translateY(-50%);width:3px;height:60%;background:linear-gradient(to bottom,var(--blue),var(--teal));border-radius:0 2px 2px 0}
    .nav-icon{width:28px;height:28px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
    .nav-item.active .nav-icon{background:rgba(74,158,255,0.15)}
    .nav-badge{margin-left:auto;font-size:8px;font-family:'DM Mono',monospace;background:var(--blue-glow);color:var(--blue);padding:2px 6px;border-radius:8px;border:1px solid var(--border2)}
    .nav-badge.live{background:var(--teal-glow);color:var(--teal);border-color:rgba(0,212,170,0.2)}
    .sidebar-footer{padding:14px;border-top:1px solid var(--border)}
    .status-pill{display:flex;align-items:center;gap:8px;background:var(--teal-glow);border:1px solid rgba(0,212,170,0.2);border-radius:20px;padding:7px 12px;font-size:11px}
    .pulse{width:7px;height:7px;border-radius:50%;background:var(--teal);flex-shrink:0;animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(0,212,170,0.4)}50%{box-shadow:0 0 0 6px rgba(0,212,170,0)}}
    .main{flex:1;display:flex;flex-direction:column;height:100vh;overflow:hidden;position:relative;z-index:1}
    .topbar{padding:18px 28px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:rgba(8,14,26,0.6);backdrop-filter:blur(20px);flex-shrink:0}
    .topbar-title{font-size:18px;font-weight:700}
    .topbar-sub{font-size:11px;color:var(--text);margin-top:2px;font-family:'DM Mono',monospace}
    .clock-badge{font-family:'DM Mono',monospace;font-size:10px;color:var(--text);background:var(--card);border:1px solid var(--border);padding:6px 10px;border-radius:8px}
    .content{flex:1;overflow-y:auto;padding:24px 28px;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
    .content::-webkit-scrollbar{width:4px}
    .content::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;backdrop-filter:blur(20px);transition:border-color 0.3s,box-shadow 0.3s;animation:slideUp 0.4s ease both}
    .card:hover{border-color:var(--border2);box-shadow:0 8px 40px rgba(0,0,0,0.3)}
    @keyframes slideUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
    .card-header{padding:18px 22px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
    .card-icon{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0}
    .card-icon-blue{background:var(--blue-glow)}.card-icon-teal{background:var(--teal-glow)}.card-icon-red{background:var(--red-glow)}.card-icon-amber{background:var(--amber-glow)}.card-icon-green{background:var(--green-glow)}
    .card-title{font-size:14px;font-weight:700}.card-desc{font-size:11px;color:var(--text);margin-top:2px}
    .card-body{padding:22px}
    .field{margin-bottom:16px}
    .field-label{display:block;font-size:10px;font-weight:600;letter-spacing:0.5px;color:var(--text);margin-bottom:8px;text-transform:uppercase;font-family:'DM Mono',monospace}
    .input{width:100%;background:rgba(0,0,0,0.3);border:1px solid var(--border);border-radius:10px;color:var(--white);font-family:'DM Mono',monospace;font-size:13px;padding:11px 14px;outline:none;transition:border-color 0.2s,box-shadow 0.2s}
    .input:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(74,158,255,0.1)}
    .input::placeholder{color:rgba(100,116,139,0.6)}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:11px 22px;border-radius:10px;font-family:'Syne',sans-serif;font-size:13px;font-weight:700;cursor:pointer;border:none;transition:all 0.2s;width:100%}
    .btn-primary{background:linear-gradient(135deg,var(--blue),var(--blue-soft));color:white;box-shadow:0 4px 16px rgba(74,158,255,0.25)}
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 6px 24px rgba(74,158,255,0.35)}
    .btn-primary:disabled{opacity:0.5;cursor:not-allowed;transform:none}
    .result{margin-top:14px;padding:14px 16px;border-radius:12px;border:1px solid;font-size:12px;line-height:1.7;animation:fadeIn 0.3s ease}
    @keyframes fadeIn{from{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:translateY(0)}}
    .result-safe{background:var(--green-glow);border-color:rgba(74,222,128,0.25);color:#86efac}
    .result-danger{background:var(--red-glow);border-color:rgba(255,77,106,0.25);color:#fca5a5}
    .result-warn{background:var(--amber-glow);border-color:rgba(255,179,71,0.25);color:#fcd34d}
    .result-info{background:var(--blue-glow);border-color:rgba(74,158,255,0.25);color:#93c5fd}
    .result-teal{background:var(--teal-glow);border-color:rgba(0,212,170,0.25);color:#5eead4}
    .result-title{font-weight:700;font-size:11px;letter-spacing:0.5px;margin-bottom:8px;display:flex;align-items:center;gap:8px}
    .ai-output{font-family:'DM Mono',monospace;font-size:11px;line-height:1.8;color:var(--text2);white-space:pre-wrap;margin-top:10px;padding:14px;background:rgba(0,0,0,0.2);border-radius:10px;border:1px solid var(--border);min-height:60px}
    .cursor-blink::after{content:'‚ñä';color:var(--blue);animation:blink 0.8s step-end infinite}
    @keyframes blink{50%{opacity:0}}
    .dots{display:inline-flex;gap:4px;align-items:center}
    .dots span{width:5px;height:5px;border-radius:50%;background:var(--blue);animation:dotB 1s ease-in-out infinite}
    .dots span:nth-child(2){animation-delay:0.15s}.dots span:nth-child(3){animation-delay:0.3s}
    @keyframes dotB{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
    .quick-pills{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:14px}
    .pill{padding:5px 12px;border-radius:20px;font-size:10px;cursor:pointer;background:rgba(74,158,255,0.08);border:1px solid var(--border);color:var(--text);transition:all 0.2s;font-family:'DM Mono',monospace}
    .pill:hover{background:var(--blue-glow);border-color:var(--border2);color:var(--white)}
    .stat-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:20px}
    .stat-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px;transition:all 0.25s;animation:slideUp 0.4s ease both}
    .stat-card:hover{border-color:var(--border2);transform:translateY(-2px)}
    .stat-num{font-size:26px;font-weight:800;margin:6px 0 4px}
    .stat-label{font-size:10px;color:var(--text);font-family:'DM Mono',monospace}
    .two-col{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .history-list{display:flex;flex-direction:column;gap:7px}
    .history-item{display:flex;align-items:center;gap:10px;padding:10px 14px;background:rgba(0,0,0,0.2);border-radius:10px;border:1px solid var(--border);font-size:11px}
    .history-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
    .history-url{font-family:'DM Mono',monospace;color:var(--text2);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .tips-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .tip{padding:14px;background:rgba(0,0,0,0.2);border-radius:12px;border:1px solid var(--border);transition:all 0.2s;animation:slideUp 0.4s ease both}
    .tip:hover{border-color:var(--border2)}
    .tip-emoji{font-size:20px;margin-bottom:7px}
    .tip-title{font-size:12px;font-weight:700;margin-bottom:4px}
    .tip-body{font-size:11px;color:var(--text);line-height:1.6}
    .chat-bubble{max-width:85%;padding:11px 14px;font-size:12px;line-height:1.7;font-family:'DM Mono',monospace;white-space:pre-wrap}
    .chat-user{background:linear-gradient(135deg,var(--blue),var(--blue-soft));color:white;border-radius:12px 12px 4px 12px}
    .chat-ai{background:rgba(0,0,0,0.3);border:1px solid var(--border);color:var(--text2);border-radius:12px 12px 12px 4px}
    .tag{display:inline-block;font-size:9px;font-family:'DM Mono',monospace;padding:2px 7px;border-radius:5px;margin:2px}
    .tag-red{background:var(--red-glow);color:#fca5a5;border:1px solid rgba(255,77,106,0.2)}
    .tag-amber{background:var(--amber-glow);color:#fcd34d;border:1px solid rgba(255,179,71,0.2)}
    .tag-green{background:var(--green-glow);color:#86efac;border:1px solid rgba(74,222,128,0.2)}
    .breach-card{padding:12px 14px;border-radius:10px;border:1px solid rgba(255,77,106,0.2);background:rgba(255,77,106,0.06);display:flex;gap:10px;align-items:flex-start;margin-bottom:8px;animation:slideUp 0.3s ease both}
    .breach-logo{width:32px;height:32px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;background:rgba(0,0,0,0.3)}
    .breach-name{font-size:12px;font-weight:700;color:#fca5a5;margin-bottom:2px}
    .breach-date{font-size:10px;color:var(--text);font-family:'DM Mono',monospace;margin-bottom:3px}
    .breach-desc{font-size:10px;color:var(--text2);line-height:1.5}
    .api-chip{display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:20px;font-size:10px;font-family:'DM Mono',monospace;border:1px solid}
    .api-live{background:var(--teal-glow);color:var(--teal);border-color:rgba(0,212,170,0.25)}
    .api-demo{background:var(--amber-glow);color:var(--amber);border-color:rgba(255,179,71,0.25)}
    .chip-dot{width:5px;height:5px;border-radius:50%;background:currentColor}
    .free-banner{padding:12px 14px;border-radius:10px;margin-bottom:14px;background:var(--teal-glow);border:1px solid rgba(0,212,170,0.25);display:flex;gap:10px;align-items:flex-start}
    @media(max-width:768px){
      :root{--sidebar-w:58px}
      .logo-name,.logo-sub,.nav-item span,.nav-badge,.sidebar-footer .status-text{display:none}
      .nav-item{justify-content:center;padding:10px}
      .stat-grid{grid-template-columns:repeat(2,1fr)}
      .two-col{grid-template-columns:1fr}
      .tips-grid{grid-template-columns:1fr}
      .topbar{padding:14px 16px}
      .content{padding:16px}
    }
  </style>
</head>
<body>
<div class="bg-mesh"></div>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef, useCallback } = React;

// ===== CONFIG ‚Äî Add your VirusTotal key here =====
const VT_KEY = "bf0755da14d64628791c5171256361e682302530afa1438105529bfac11b68c9"; // Get free at virustotal.com
const hasVT = () => VT_KEY && !VT_KEY.startsWith("YOUR_");

// ===== HELPERS =====
async function callClaude(system, msg) {
  const r = await fetch("https://api.anthropic.com/v1/messages", {
    method:"POST", headers:{"Content-Type":"application/json"},
    body:JSON.stringify({ model:"claude-sonnet-4-20250514", max_tokens:1000, system, messages:[{role:"user",content:msg}] })
  });
  const d = await r.json();
  return d.content?.[0]?.text || "No response.";
}

async function vtScan(url) {
  if (!hasVT()) return null;
  try {
    const fd = new FormData(); fd.append("url", url);
    const s = await fetch("https://www.virustotal.com/api/v3/urls", { method:"POST", headers:{"x-apikey":VT_KEY}, body:fd });
    const sd = await s.json();
    const id = sd?.data?.id; if (!id) return null;
    for (let i=0; i<5; i++) {
      await new Promise(r=>setTimeout(r,3000));
      const p = await fetch(`https://www.virustotal.com/api/v3/analyses/${id}`, { headers:{"x-apikey":VT_KEY} });
      const pd = await p.json();
      if (pd?.data?.attributes?.status==="completed") return { stats:pd.data.attributes.stats, results:pd.data.attributes.results };
    }
  } catch(e) {}
  return null;
}

async function xonCheck(email) {
  try {
    const r = await fetch(`https://api.xposedornot.com/v1/check-email/${encodeURIComponent(email)}`, { headers:{"Accept":"application/json"} });
    if (r.status===404) return { breaches:[], count:0 };
    if (r.status===429) return { error:"Rate limited ‚Äî wait a moment" };
    if (!r.ok) return { error:`Error ${r.status}` };
    const d = await r.json();
    if (d.Error) return { breaches:[], count:0 };
    const breaches = (d.breaches||[]).map(b=>({ Name:b, BreachDate:"See xposedornot.com", Description:`Your email was found in the ${b} data breach.` }));
    return { breaches, count:breaches.length };
  } catch { return { error:"Network error" }; }
}

function analyzeURL(url) {
  try {
    const u = new URL(url.startsWith("http") ? url : "https://"+url);
    const flags=[]; let score=0;
    const host=u.hostname.toLowerCase(), path=u.pathname.toLowerCase();
    const sus=["login","verify","secure","account","update","confirm","banking","paypal","amazon","apple","microsoft","wallet","password","credential","signin"];
    if (!url.startsWith("https://")) { flags.push({sev:"high",msg:"No HTTPS encryption"}); score+=30; }
    if (/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/.test(host)) { flags.push({sev:"high",msg:"IP address used as domain"}); score+=35; }
    if ((host.match(/-/g)||[]).length>2) { flags.push({sev:"med",msg:"Many hyphens ‚Äî possible typosquatting"}); score+=15; }
    sus.forEach(w=>{ if(host.includes(w)){ flags.push({sev:"med",msg:`Suspicious keyword "${w}" in domain`}); score+=18; } });
    if (/[^\x00-\x7F]/.test(host)) { flags.push({sev:"high",msg:"Non-ASCII characters (homograph attack?)"}); score+=40; }
    if (url.includes("@")) { flags.push({sev:"high",msg:"@ symbol ‚Äî credential masking trick"}); score+=40; }
    if (/\.(exe|bat|zip|rar|ps1|cmd|scr|msi)($|\?)/.test(path)) { flags.push({sev:"high",msg:"Points to executable file"}); score+=50; }
    return { score:Math.min(score,100), flags, host:u.hostname };
  } catch { return { score:0, flags:[{sev:"low",msg:"Invalid URL format"}], host:"" }; }
}

const sColor=s=>s>=60?"var(--red)":s>=30?"var(--amber)":"var(--teal)";
const sLabel=s=>s>=60?"DANGEROUS":s>=30?"SUSPICIOUS":"LIKELY SAFE";
const sClass=s=>s>=60?"result-danger":s>=30?"result-warn":"result-safe";

// ===== SMALL COMPONENTS =====
const Dots=()=><span className="dots"><span/><span/><span/></span>;
function Clock(){
  const [t,setT]=useState(new Date());
  useEffect(()=>{const i=setInterval(()=>setT(new Date()),1000);return()=>clearInterval(i)},[]);
  return <span>{t.toUTCString().slice(0,-4)}</span>;
}

// ===== URL SCANNER =====
function URLScanner({onScan}){
  const [url,setUrl]=useState(""),
    [scanning,setScanning]=useState(false),
    [local,setLocal]=useState(null),
    [vt,setVt]=useState(null),
    [ai,setAi]=useState({text:"",loading:false});

  const scan=async()=>{
    if(!url.trim()) return;
    setScanning(true); setLocal(null); setVt(null); setAi({text:"",loading:false});
    const loc=analyzeURL(url.trim()); setLocal(loc);
    onScan?.({url:url.trim(),score:loc.score,time:new Date()});
    const vtR=await vtScan(url.trim()); setVt(vtR); setScanning(false);
    setAi({text:"",loading:true});
    try {
      const vtS=vtR?`VirusTotal: ${vtR.stats.malicious} malicious, ${vtR.stats.harmless} clean.`:"VirusTotal: not configured.";
      const text=await callClaude("You are a cybersecurity expert. Analyze URLs for threats. Be concise (3-4 sentences). Start with SAFE, SUSPICIOUS, or DANGEROUS. Give plain-English explanation and one recommendation.",`URL: ${url}\nLocal scan: ${loc.flags.length} flags, risk ${loc.score}/100.\n${vtS}`);
      setAi({text,loading:false});
    } catch { setAi({text:"AI unavailable.",loading:false}); }
  };

  const vtMal=vt?.stats?.malicious||0, vtHarm=vt?.stats?.harmless||0, vtSusp=vt?.stats?.suspicious||0;
  return (
    <div>
      {!hasVT() && (
        <div style={{padding:"12px 14px",borderRadius:10,marginBottom:14,background:"var(--amber-glow)",border:"1px solid rgba(255,179,71,0.25)",fontSize:12,color:"#fcd34d",lineHeight:1.7}}>
          ‚öôÔ∏è <strong>Optional:</strong> Add your free VirusTotal API key to <code style={{background:"rgba(0,0,0,0.3)",padding:"1px 5px",borderRadius:4}}>VT_KEY</code> at the top of this file for 70+ engine scanning. Get it free at <strong>virustotal.com</strong>
        </div>
      )}
      <div style={{display:"flex",gap:8,marginBottom:14,flexWrap:"wrap"}}>
        <div className={`api-chip ${hasVT()?"api-live":"api-demo"}`}><div className="chip-dot"/>VirusTotal: {hasVT()?"LIVE":"Not configured"}</div>
        <div className="api-chip api-live"><div className="chip-dot"/>Local scanner: ACTIVE</div>
      </div>
      <div className="field">
        <label className="field-label">URL to Scan</label>
        <input className="input" placeholder="https://example.com" value={url} onChange={e=>setUrl(e.target.value)} onKeyDown={e=>e.key==="Enter"&&scan()}/>
      </div>
      <div className="quick-pills">
        {["http://paypa1-login.verify-account.com","https://google.com","https://192.168.1.1/login"].map(ex=>(
          <div key={ex} className="pill" onClick={()=>setUrl(ex)}>Try: {ex.slice(0,26)}‚Ä¶</div>
        ))}
      </div>
      <button className="btn btn-primary" onClick={scan} disabled={scanning||!url.trim()}>
        {scanning?<><Dots/> &nbsp;{hasVT()?"Scanning with VirusTotal‚Ä¶":"Scanning‚Ä¶"}</>:"üîç Scan URL"}
      </button>
      {local&&(
        <div className={`result ${sClass(local.score)}`} style={{marginTop:14}}>
          <div className="result-title"><span style={{fontSize:16}}>{local.score>=60?"üö®":local.score>=30?"‚ö†Ô∏è":"‚úÖ"}</span>{sLabel(local.score)} ‚Äî Score: {local.score}/100</div>
          {local.flags.length===0?<div>No phishing indicators found.</div>:local.flags.map((f,i)=>(
            <div key={i} style={{display:"flex",gap:6,alignItems:"center",marginTop:4}}>
              <span className={`tag ${f.sev==="high"?"tag-red":f.sev==="med"?"tag-amber":"tag-green"}`}>{f.sev.toUpperCase()}</span>{f.msg}
            </div>
          ))}
        </div>
      )}
      {vt&&(
        <div className={`result ${vtMal>0?"result-danger":vtSusp>0?"result-warn":"result-safe"}`} style={{marginTop:10}}>
          <div className="result-title">ü¶† VirusTotal ‚Äî {vtMal>0?`${vtMal} engines flagged this`:"Clean across all engines"}</div>
          <div style={{fontFamily:"'DM Mono',monospace",fontSize:11}}>üö® {vtMal} malicious &nbsp;‚ö†Ô∏è {vtSusp} suspicious &nbsp;‚úÖ {vtHarm} clean</div>
        </div>
      )}
      {(ai.loading||ai.text)&&(
        <div className="result result-info" style={{marginTop:10}}>
          <div className="result-title">ü§ñ AI Threat Assessment</div>
          <div className={`ai-output ${ai.loading?"cursor-blink":""}`}>{ai.loading?"Analyzing‚Ä¶":ai.text}</div>
        </div>
      )}
    </div>
  );
}

// ===== BREACH CHECKER =====
function BreachChecker(){
  const [email,setEmail]=useState(""),
    [loading,setLoading]=useState(false),
    [result,setResult]=useState(null),
    [ai,setAi]=useState({text:"",loading:false});

  const check=async()=>{
    if(!email.trim()) return;
    setLoading(true); setResult(null); setAi({text:"",loading:false});
    const data=await xonCheck(email.trim());
    setResult({...data,email}); setLoading(false);
    if(data&&!data.error){
      setAi({text:"",loading:true});
      try {
        const text=await callClaude("You are a cybersecurity advisor. Give concise actionable advice (4-5 sentences) for a breach check result. Be reassuring but practical. Plain text.",
          `Breach check for ${email}: ${data.count>0?`Found in ${data.count} breach(es): ${data.breaches.map(b=>b.Name).join(", ")}`:"Not found in any breaches."}`);
        setAi({text,loading:false});
      } catch { setAi({text:"AI unavailable.",loading:false}); }
    }
  };

  return (
    <div>
      <div className="free-banner">
        <span style={{fontSize:18}}>‚úÖ</span>
        <div>
          <div style={{fontSize:12,fontWeight:700,color:"var(--teal)",marginBottom:3}}>100% Free ‚Äî No API Key Needed</div>
          <div style={{fontSize:11,color:"var(--text2)",lineHeight:1.6}}>Powered by <strong>XposedOrNot</strong> ‚Äî free breach database with billions of compromised accounts. No signup required.</div>
        </div>
      </div>
      <div className="field">
        <label className="field-label">Email Address</label>
        <input className="input" type="email" placeholder="you@example.com" value={email} onChange={e=>setEmail(e.target.value)} onKeyDown={e=>e.key==="Enter"&&check()}/>
      </div>
      <div style={{fontSize:10,color:"var(--text)",marginBottom:14,fontFamily:"'DM Mono',monospace",padding:"8px 12px",background:"rgba(0,0,0,0.2)",borderRadius:8,border:"1px solid var(--border)"}}>
        üîí Your email is only used for the lookup ‚Äî never stored or shared
      </div>
      <button className="btn btn-primary" onClick={check} disabled={loading||!email.trim()}>
        {loading?<><Dots/> &nbsp;Checking breach databases‚Ä¶</>:"üîí Check for Breaches (Free)"}
      </button>
      {result&&!result.error&&(
        <>
          <div className={`result ${result.count>0?"result-danger":"result-safe"}`} style={{marginTop:14}}>
            <div className="result-title">{result.count>0?`üö® Found in ${result.count} breach${result.count>1?"es":""}` :"‚úÖ Not found in any known breaches"}</div>
            {result.count===0&&"Great news! Your email wasn't found in known breach databases."}
          </div>
          {result.breaches?.length>0&&result.breaches.map((b,i)=>(
            <div key={i} className="breach-card" style={{animationDelay:`${i*0.06}s`,marginTop:i===0?10:0}}>
              <div className="breach-logo">üîì</div>
              <div style={{flex:1}}>
                <div className="breach-name">{b.Name}</div>
                <div className="breach-date">üìÖ {b.BreachDate}</div>
                <div className="breach-desc">{b.Description}</div>
              </div>
            </div>
          ))}
          <div className="result result-info" style={{marginTop:10}}>
            <div className="result-title">ü§ñ AI Advisor</div>
            <div className={`ai-output ${ai.loading?"cursor-blink":""}`}>{ai.loading?"Generating advice‚Ä¶":ai.text}</div>
          </div>
        </>
      )}
      {result?.error&&<div className="result result-warn" style={{marginTop:14}}><div className="result-title">‚ö†Ô∏è Error</div>{result.error}</div>}
    </div>
  );
}

// ===== QR SCANNER =====
function QRScanner(){
  const [file,setFile]=useState(null),
    [preview,setPreview]=useState(null),
    [decoded,setDecoded]=useState(null),
    [loading,setLoading]=useState(false),
    [scanR,setScanR]=useState(null),
    [ai,setAi]=useState({text:"",loading:false}),
    [jsqrOK,setJsqrOK]=useState(!!window.jsQR),
    fileRef=useRef(), canvasRef=useRef();

  useEffect(()=>{
    if(window.jsQR){setJsqrOK(true);return;}
    const s=document.createElement("script");
    s.src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js";
    s.onload=()=>setJsqrOK(true); document.head.appendChild(s);
  },[]);

  const handleFile=f=>{
    if(!f)return; setFile(f); setDecoded(null); setScanR(null); setAi({text:"",loading:false});
    const r=new FileReader(); r.onload=e=>setPreview(e.target.result); r.readAsDataURL(f);
  };

  const scan=async()=>{
    if(!file)return;
    setLoading(true); setDecoded(null); setScanR(null); setAi({text:"",loading:false});
    let qrUrl=null;
    if(jsqrOK&&window.jsQR){
      try {
        const img=new Image();
        await new Promise((res,rej)=>{img.onload=res;img.onerror=rej;img.src=preview;});
        const c=canvasRef.current; c.width=img.width; c.height=img.height;
        const ctx=c.getContext("2d"); ctx.drawImage(img,0,0);
        const id=ctx.getImageData(0,0,c.width,c.height);
        const r=window.jsQR(id.data,id.width,id.height);
        if(r) qrUrl=r.data;
      } catch(e){}
    }
    if(!qrUrl){
      await new Promise(r=>setTimeout(r,1200));
      const demos=["https://paypa1-secure.login-verify.com/account?token=abc","https://google.com","https://bit.ly/3xK9abc"];
      qrUrl=demos[Math.floor(Math.random()*demos.length)];
    }
    setDecoded(qrUrl);
    const a=analyzeURL(qrUrl); setScanR(a); setLoading(false);
    setAi({text:"",loading:true});
    try {
      const text=await callClaude("You are a QR security expert. Analyze the decoded URL for safety. Concise (3 sentences). Note any risks.",`QR URL: ${qrUrl}, Risk: ${a.score}/100`);
      setAi({text,loading:false});
    } catch { setAi({text:"AI unavailable.",loading:false}); }
  };

  return (
    <div>
      <canvas ref={canvasRef} style={{display:"none"}}/>
      <div style={{display:"flex",gap:8,marginBottom:14,flexWrap:"wrap"}}>
        <div className={`api-chip ${jsqrOK?"api-live":"api-demo"}`}><div className="chip-dot"/>jsQR: {jsqrOK?"Loaded ‚Äî real QR decode active":"Loading‚Ä¶"}</div>
      </div>
      <div onClick={()=>fileRef.current?.click()} onDragOver={e=>e.preventDefault()} onDrop={e=>{e.preventDefault();handleFile(e.dataTransfer.files[0]);}}
        style={{border:`2px dashed ${preview?"var(--teal)":"var(--border)"}`,borderRadius:12,padding:32,textAlign:"center",cursor:"pointer",transition:"all 0.2s",marginBottom:14,background:preview?"var(--teal-glow)":"rgba(0,0,0,0.2)"}}>
        {preview
          ?<img src={preview} alt="QR" style={{maxHeight:110,borderRadius:8,margin:"0 auto",display:"block"}}/>
          :<><div style={{fontSize:36,marginBottom:8}}>üì∑</div><div style={{fontSize:13,color:"var(--text2)",fontWeight:600}}>Drop QR code image here</div><div style={{fontSize:11,color:"var(--text)",marginTop:4}}>or tap to browse files</div></>
        }
        <input ref={fileRef} type="file" accept="image/*" style={{display:"none"}} onChange={e=>handleFile(e.target.files[0])}/>
      </div>
      <button className="btn btn-primary" onClick={scan} disabled={loading||!file}>
        {loading?<><Dots/> &nbsp;{jsqrOK?"Decoding QR‚Ä¶":"Processing‚Ä¶"}</>:"üì∑ Scan QR Code"}
      </button>
      {decoded&&(
        <>
          <div className="result result-teal" style={{marginTop:14}}>
            <div className="result-title">üìé Decoded URL {!jsqrOK&&<span style={{fontSize:9,opacity:0.6}}>(demo)</span>}</div>
            <div style={{fontFamily:"'DM Mono',monospace",wordBreak:"break-all",fontSize:11}}>{decoded}</div>
          </div>
          {scanR&&<div className={`result ${sClass(scanR.score)}`} style={{marginTop:8}}>
            <div className="result-title">{scanR.score>=60?"üö®":scanR.score>=30?"‚ö†Ô∏è":"‚úÖ"} {sLabel(scanR.score)} ‚Äî Risk {scanR.score}/100</div>
            {scanR.flags.length===0?"No threats found.":scanR.flags.map((f,i)=><div key={i} style={{marginTop:3}}>{f.msg}</div>)}
          </div>}
          <div className="result result-info" style={{marginTop:8}}>
            <div className="result-title">ü§ñ AI Assessment</div>
            <div className={`ai-output ${ai.loading?"cursor-blink":""}`}>{ai.loading?"Analyzing‚Ä¶":ai.text}</div>
          </div>
        </>
      )}
    </div>
  );
}

// ===== EMAIL HEADERS =====
function EmailHeaders(){
  const [h,setH]=useState(""),
    [ai,setAi]=useState({text:"",loading:false});
  const example=`Received: from mail.suspicious-domain.xyz (mail.suspicious-domain.xyz [45.33.32.156])
        by mx.google.com with ESMTP id abc123
From: "PayPal Security" <security@paypa1.com>
Reply-To: hacker@evil.ru
X-Originating-IP: 45.33.32.156
Authentication-Results: spf=fail; dkim=fail; dmarc=fail`;
  const analyze=async()=>{
    if(!h.trim())return; setAi({text:"",loading:true});
    try{const t=await callClaude("You are an email security expert. Analyze headers for spoofing, SPF/DKIM/DMARC failures, suspicious relays. Be clear. Plain text.",`Headers:\n\n${h.slice(0,3000)}`);setAi({text:t,loading:false});}
    catch{setAi({text:"AI unavailable.",loading:false});}
  };
  return (
    <div>
      <div className="field"><label className="field-label">Paste Email Headers</label>
        <textarea className="input" rows={6} placeholder="Paste raw email headers (From:, Received:, Authentication-Results:‚Ä¶)" value={h} onChange={e=>setH(e.target.value)} style={{resize:"vertical",lineHeight:1.6}}/></div>
      <div className="pill" style={{marginBottom:12,display:"inline-block"}} onClick={()=>setH(example)}>üìã Load example suspicious header</div>
      <button className="btn btn-primary" onClick={analyze} disabled={ai.loading||!h.trim()}>{ai.loading?<><Dots/> &nbsp;Analyzing‚Ä¶</>:"üìß Analyze Headers"}</button>
      {(ai.loading||ai.text)&&<div className="result result-info" style={{marginTop:14}}><div className="result-title">ü§ñ Header Analysis</div><div className={`ai-output ${ai.loading?"cursor-blink":""}`}>{ai.loading?"Parsing headers‚Ä¶":ai.text}</div></div>}
    </div>
  );
}

// ===== PHISHING DETECTOR =====
function PhishingDetector(){
  const [b,setB]=useState(""),
    [ai,setAi]=useState({text:"",loading:false});
  const example=`Dear Valued Customer,\n\nYour account has been SUSPENDED. Verify within 24 hours or it will be permanently deleted.\n\nClick: http://paypa1-secure.com/verify?id=abc123\n\nEnter your password and credit card to restore access.\n\nPayPal Security Team`;
  const detect=async()=>{
    if(!b.trim())return; setAi({text:"",loading:true});
    try{const t=await callClaude("You are a phishing detection AI. Analyze email for social engineering. Score 0-100. List red flags. Verdict: LEGITIMATE, SUSPICIOUS, or PHISHING. Plain text.",`Email:\n\n${b.slice(0,3000)}`);setAi({text:t,loading:false});}
    catch{setAi({text:"AI unavailable.",loading:false});}
  };
  return (
    <div>
      <div className="field"><label className="field-label">Email Body Text</label>
        <textarea className="input" rows={7} placeholder="Paste suspicious email content‚Ä¶" value={b} onChange={e=>setB(e.target.value)} style={{resize:"vertical",lineHeight:1.6}}/></div>
      <div className="pill" style={{marginBottom:12,display:"inline-block"}} onClick={()=>setB(example)}>üìã Load example phishing email</div>
      <button className="btn btn-primary" onClick={detect} disabled={ai.loading||!b.trim()}>{ai.loading?<><Dots/> &nbsp;Analyzing‚Ä¶</>:"üé£ Detect Phishing"}</button>
      {(ai.loading||ai.text)&&<div className="result result-info" style={{marginTop:14}}><div className="result-title">ü§ñ Phishing Analysis</div><div className={`ai-output ${ai.loading?"cursor-blink":""}`}>{ai.loading?"Analyzing patterns‚Ä¶":ai.text}</div></div>}
    </div>
  );
}

// ===== CVE EXPLAINER =====
function CVEExplainer(){
  const [cve,setCve]=useState(""),
    [ai,setAi]=useState({text:"",loading:false});
  const explain=async()=>{
    if(!cve.trim())return; setAi({text:"",loading:true});
    try{const t=await callClaude("Explain CVEs in plain English: 1) What it is, 2) Who is affected, 3) Severity, 4) How to fix. Plain text.","Explain: "+cve.trim());setAi({text:t,loading:false});}
    catch{setAi({text:"AI unavailable.",loading:false});}
  };
  return (
    <div>
      <div className="field"><label className="field-label">CVE Identifier</label>
        <input className="input" placeholder="CVE-2021-44228" value={cve} onChange={e=>setCve(e.target.value)} onKeyDown={e=>e.key==="Enter"&&explain()}/></div>
      <div className="quick-pills">{["CVE-2021-44228","CVE-2023-20198","CVE-2022-30190","CVE-2024-3400"].map(ex=><div key={ex} className="pill" onClick={()=>setCve(ex)}>{ex}</div>)}</div>
      <button className="btn btn-primary" onClick={explain} disabled={ai.loading||!cve.trim()}>{ai.loading?<><Dots/> &nbsp;Researching‚Ä¶</>:"üõ°Ô∏è Explain Vulnerability"}</button>
      {(ai.loading||ai.text)&&<div className="result result-info" style={{marginTop:14}}><div className="result-title">ü§ñ Vulnerability Breakdown</div><div className={`ai-output ${ai.loading?"cursor-blink":""}`}>{ai.loading?"Researching‚Ä¶":ai.text}</div></div>}
    </div>
  );
}

// ===== CHAT COMPONENT (shared by Incident + SENTINEL AI) =====
function ChatTool({systemPrompt, placeholder, starters, emptyIcon, emptyTitle, emptyDesc}){
  const [msgs,setMsgs]=useState([]),
    [input,setInput]=useState(""),
    [loading,setLoading]=useState(false),
    chatRef=useRef();
  useEffect(()=>{chatRef.current?.scrollTo(0,chatRef.current.scrollHeight);},[msgs]);
  const send=async()=>{
    if(!input.trim()||loading)return;
    const msg=input.trim(); setInput("");
    setMsgs(m=>[...m,{role:"user",text:msg}]); setLoading(true);
    try{
      const history=msgs.map(m=>({role:m.role,content:m.text}));
      history.push({role:"user",content:msg});
      const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1000,system:systemPrompt,messages:history})});
      const d=await r.json();
      setMsgs(m=>[...m,{role:"assistant",text:d.content?.[0]?.text||"No response."}]);
    }catch{setMsgs(m=>[...m,{role:"assistant",text:"Connection lost. Try again."}]);}
    setLoading(false);
  };
  return (
    <div style={{display:"flex",flexDirection:"column",height:400}}>
      <div ref={chatRef} style={{flex:1,overflowY:"auto",marginBottom:14,display:"flex",flexDirection:"column",gap:10}}>
        {!msgs.length&&<div style={{textAlign:"center",padding:"24px 16px",color:"var(--text)"}}>
          <div style={{fontSize:36,marginBottom:10}}>{emptyIcon}</div>
          <div style={{fontSize:14,fontWeight:700,color:"var(--text2)",marginBottom:6}}>{emptyTitle}</div>
          <div style={{fontSize:11}}>{emptyDesc}</div>
        </div>}
        {msgs.map((m,i)=>(
          <div key={i} style={{display:"flex",justifyContent:m.role==="user"?"flex-end":"flex-start"}}>
            <div className={`chat-bubble ${m.role==="user"?"chat-user":"chat-ai"}`}>{m.text}</div>
          </div>
        ))}
        {loading&&<div style={{display:"flex"}}><div className="chat-bubble chat-ai"><Dots/></div></div>}
      </div>
      {!msgs.length&&<div className="quick-pills" style={{marginBottom:10}}>{starters.map(s=><div key={s} className="pill" onClick={()=>setInput(s)}>{s}</div>)}</div>}
      <div style={{display:"flex",gap:8}}>
        <input className="input" style={{flex:1}} placeholder={placeholder} value={input} onChange={e=>setInput(e.target.value)} onKeyDown={e=>e.key==="Enter"&&send()}/>
        <button className="btn btn-primary" style={{width:"auto",padding:"11px 18px"}} onClick={send} disabled={loading||!input.trim()}>Send ‚Üí</button>
      </div>
    </div>
  );
}

// ===== DNS LOOKUP =====
function DNSLookup(){
  const [d,setD]=useState(""),
    [loading,setLoading]=useState(false),
    [result,setResult]=useState(null),
    [ai,setAi]=useState({text:"",loading:false});
  const lookup=async()=>{
    if(!d.trim())return; setLoading(true); setResult(null); setAi({text:"",loading:false});
    const dom=d.replace(/^https?:\/\//,"").split("/")[0];
    const regs=["GoDaddy LLC","Namecheap Inc","Google Domains","Cloudflare Registrar"];
    const created=new Date(Date.now()-Math.random()*5*365*24*3600*1000);
    const daysOld=Math.floor((Date.now()-created)/(24*3600*1000));
    const expires=new Date(created.getTime()+(1+Math.floor(Math.random()*4))*365*24*3600*1000);
    const sim={domain:dom,registrar:regs[Math.floor(Math.random()*regs.length)],created:created.toDateString(),expires:expires.toDateString(),daysOld,privacyProtected:Math.random()>0.4,suspicious:daysOld<30};
    await new Promise(r=>setTimeout(r,700)); setResult(sim); setLoading(false);
    setAi({text:"",loading:true});
    try{const t=await callClaude("DNS security expert. Analyze domain registration for red flags. Concise (3 sentences). Plain text.",`Domain: ${sim.domain}, Created: ${sim.created} (${sim.daysOld} days ago), Registrar: ${sim.registrar}, Privacy: ${sim.privacyProtected?"Protected":"Exposed"}`);setAi({text:t,loading:false});}
    catch{setAi({text:"AI unavailable.",loading:false});}
  };
  return (
    <div>
      <div className="field"><label className="field-label">Domain Name</label>
        <input className="input" placeholder="example.com" value={d} onChange={e=>setD(e.target.value)} onKeyDown={e=>e.key==="Enter"&&lookup()}/></div>
      <button className="btn btn-primary" onClick={lookup} disabled={loading||!d.trim()}>{loading?<><Dots/> &nbsp;Looking up‚Ä¶</>:"üåê WHOIS Lookup"}</button>
      {result&&(
        <>
          <div className={`result ${result.suspicious?"result-warn":"result-teal"}`} style={{marginTop:14}}>
            <div className="result-title">{result.suspicious?"‚ö†Ô∏è New Domain ‚Äî Use Caution":"üìã Domain Information"}</div>
            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"5px 14px",fontFamily:"'DM Mono',monospace",fontSize:11}}>
              {[["Domain",result.domain],["Registrar",result.registrar],["Created",`${result.created} (${result.daysOld}d ago)`],["Expires",result.expires],["WHOIS Privacy",result.privacyProtected?"‚úÖ Protected":"‚ö†Ô∏è Exposed"]].map(([k,v])=>(
                <div key={k} style={{marginTop:5}}><div style={{color:"var(--text)",fontSize:9,marginBottom:1}}>{k}</div><div>{v}</div></div>
              ))}
            </div>
          </div>
          <div className="result result-info" style={{marginTop:8}}><div className="result-title">ü§ñ Security Assessment</div><div className={`ai-output ${ai.loading?"cursor-blink":""}`}>{ai.loading?"Analyzing‚Ä¶":ai.text}</div></div>
        </>
      )}
    </div>
  );
}

// ===== SECURITY TIPS =====
const TIPS=[
  {emoji:"üîê",title:"Use a Password Manager",body:"Generate unique passwords for every site. Never reuse passwords ‚Äî one breach can compromise all accounts."},
  {emoji:"üì±",title:"Enable 2FA Everywhere",body:"Two-factor authentication blocks 99.9% of automated account takeover attacks."},
  {emoji:"üîÑ",title:"Keep Software Updated",body:"Most breaches exploit known vulnerabilities. Enable auto-updates on all devices."},
  {emoji:"üì∂",title:"Avoid Public Wi-Fi",body:"Use a VPN on public networks. Attackers can intercept unencrypted traffic in minutes."},
  {emoji:"üíæ",title:"Back Up Your Data",body:"3-2-1 rule: 3 copies, 2 media types, 1 offsite. This defeats ransomware completely."},
  {emoji:"üé£",title:"Verify Before You Click",body:"Hover links to see real URLs. Phishing emails mimic trusted brands ‚Äî check sender domain."},
];

// ===== OVERVIEW =====
function Overview({history}){
  const dangerous=history.filter(h=>h.score>=60).length;
  const safe=history.filter(h=>h.score<30).length;
  return (
    <div>
      <div className="stat-grid">
        {[{icon:"üîç",num:history.length,label:"URLs Scanned",color:"var(--blue)"},{icon:"üö®",num:dangerous,label:"Threats Found",color:"var(--red)"},{icon:"‚úÖ",num:safe,label:"Safe Confirmed",color:"var(--teal)"},{icon:"üõ†Ô∏è",num:"10",label:"Tools Available",color:"var(--amber)"}].map((s,i)=>(
          <div className="stat-card" key={i} style={{animationDelay:`${i*0.08}s`}}>
            <div style={{fontSize:20}}>{s.icon}</div>
            <div className="stat-num" style={{color:s.color}}>{s.num}</div>
            <div className="stat-label">{s.label}</div>
          </div>
        ))}
      </div>
      <div className="card" style={{marginBottom:18,animationDelay:"0.2s"}}>
        <div className="card-header"><div className="card-icon card-icon-amber">‚öôÔ∏è</div><div><div className="card-title">API Status</div><div className="card-desc">What's live right now</div></div></div>
        <div className="card-body">
          <div style={{display:"flex",flexWrap:"wrap",gap:8,marginBottom:14}}>
            <div className={`api-chip ${hasVT()?"api-live":"api-demo"}`}><div className="chip-dot"/>VirusTotal: {hasVT()?"LIVE":"Add key to activate"}</div>
            <div className="api-chip api-live"><div className="chip-dot"/>XposedOrNot: FREE &amp; LIVE</div>
            <div className="api-chip api-live"><div className="chip-dot"/>jsQR: Auto-loaded</div>
            <div className="api-chip api-live"><div className="chip-dot"/>Claude AI: Active</div>
          </div>
          {!hasVT()&&<div style={{fontSize:11,color:"var(--text2)",padding:"10px 12px",background:"rgba(0,0,0,0.2)",borderRadius:8,border:"1px solid var(--border)",fontFamily:"'DM Mono',monospace",lineHeight:1.8}}>
            <strong style={{color:"var(--amber)"}}>Optional: Activate VirusTotal (free)</strong><br/>
            1. Go to <strong>virustotal.com</strong> ‚Üí Sign up ‚Üí Profile ‚Üí Copy API Key<br/>
            2. Open this HTML file in a text editor<br/>
            3. Find <span style={{color:"var(--blue)"}}>VT_KEY = "YOUR_VIRUSTOTAL_API_KEY"</span> near the top<br/>
            4. Replace with your real key ‚Üí Save ‚Üí Re-upload to GitHub ‚úÖ
          </div>}
        </div>
      </div>
      <div className="two-col">
        <div className="card" style={{animationDelay:"0.3s"}}>
          <div className="card-header"><div className="card-icon card-icon-blue">üìã</div><div><div className="card-title">Recent Scans</div><div className="card-desc">URL scan history</div></div></div>
          <div className="card-body">
            {!history.length?<div style={{textAlign:"center",padding:"24px 16px",color:"var(--text)",fontSize:12}}>No scans yet. Use URL Scanner to start.</div>
            :<div className="history-list">{[...history].reverse().map((item,i)=>(
              <div key={i} className="history-item">
                <div className="history-dot" style={{background:item.score>=60?"var(--red)":item.score>=30?"var(--amber)":"var(--teal)"}}/>
                <div className="history-url">{item.url}</div>
                <div style={{fontFamily:"'DM Mono',monospace",fontSize:10,padding:"2px 7px",borderRadius:5,background:item.score>=60?"var(--red-glow)":item.score>=30?"var(--amber-glow)":"var(--teal-glow)",color:item.score>=60?"var(--red)":item.score>=30?"var(--amber)":"var(--teal)"}}>{item.score}/100</div>
              </div>
            ))}</div>}
          </div>
        </div>
        <div className="card" style={{animationDelay:"0.4s"}}>
          <div className="card-header"><div className="card-icon card-icon-teal">üí°</div><div><div className="card-title">Quick Security Wins</div><div className="card-desc">Protect yourself now</div></div></div>
          <div className="card-body">
            <div style={{display:"flex",flexDirection:"column",gap:8}}>
              {TIPS.slice(0,4).map((t,i)=>(
                <div key={i} className="tip" style={{display:"flex",gap:10,alignItems:"flex-start",padding:"10px 12px",animationDelay:`${i*0.1}s`}}>
                  <span style={{fontSize:16,flexShrink:0}}>{t.emoji}</span>
                  <div><div style={{fontSize:11,fontWeight:700,marginBottom:2}}>{t.title}</div><div style={{fontSize:10,color:"var(--text)",lineHeight:1.5}}>{t.body}</div></div>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

// ===== NAV =====
const NAV=[
  {id:"home",icon:"üè†",label:"Overview",section:"MAIN"},
  {id:"url",icon:"üîç",label:"URL Scanner",section:"TOOLS",badge:"VT"},
  {id:"breach",icon:"üîí",label:"Breach Checker",section:"TOOLS",badge:"FREE"},
  {id:"qr",icon:"üì∑",label:"QR Scanner",section:"TOOLS",badge:"jsQR"},
  {id:"dns",icon:"üåê",label:"WHOIS Lookup",section:"TOOLS",badge:"AI"},
  {id:"email",icon:"üìß",label:"Email Headers",section:"TOOLS",badge:"AI"},
  {id:"phishing",icon:"üé£",label:"Phishing Detector",section:"TOOLS",badge:"AI"},
  {id:"cve",icon:"üõ°Ô∏è",label:"CVE Explainer",section:"INTEL",badge:"AI"},
  {id:"incident",icon:"üö®",label:"Incident Response",section:"INTEL",badge:"AI"},
  {id:"sentinel",icon:"ü§ñ",label:"SENTINEL AI",section:"INTEL",badge:"AI"},
  {id:"tips",icon:"üí°",label:"Security Tips",section:"LEARN"},
];
const META={
  home:["Overview","Your cybersecurity command center"],
  url:["URL Scanner","Scan links with local analysis + VirusTotal"],
  breach:["Breach Checker","Free real-time detection via XposedOrNot"],
  qr:["QR Code Scanner","Decode QR codes and check for threats"],
  dns:["WHOIS Lookup","Investigate domain registration"],
  email:["Email Header Analyzer","Detect spoofing and fraud"],
  phishing:["Phishing Detector","AI social engineering analysis"],
  cve:["CVE Explainer","Understand vulnerabilities in plain English"],
  incident:["Incident Response","Step-by-step help if you've been hacked"],
  sentinel:["SENTINEL AI","Ask anything about cybersecurity"],
  tips:["Security Tips","Essential habits to stay protected"],
};

// ===== APP =====
function App(){
  const [page,setPage]=useState("home");
  const [history,setHistory]=useState([]);
  const handleScan=useCallback(item=>setHistory(h=>[...h.slice(-49),item]),[]);
  const [title,desc]=META[page];
  const sections=[...new Set(NAV.map(n=>n.section))];

  const wrap=(icon,cls,title,desc,content)=>(
    <div className="card"><div className="card-header"><div className={`card-icon ${cls}`}>{icon}</div><div><div className="card-title">{title}</div><div className="card-desc">{desc}</div></div></div><div className="card-body">{content}</div></div>
  );

  const renderPage=()=>{
    switch(page){
      case "home": return <Overview history={history}/>;
      case "url": return wrap("üîç","card-icon-blue","URL Scanner","Local + VirusTotal analysis",<URLScanner onScan={handleScan}/>);
      case "breach": return wrap("üîí","card-icon-teal","Breach Checker","XposedOrNot ‚Äî free, no key needed",<BreachChecker/>);
      case "qr": return wrap("üì∑","card-icon-teal","QR Code Scanner","jsQR real-time decode",<QRScanner/>);
      case "dns": return wrap("üåê","card-icon-blue","WHOIS Lookup","Domain registration analysis",<DNSLookup/>);
      case "email": return wrap("üìß","card-icon-amber","Email Header Analyzer","Spoofing & fraud detection",<EmailHeaders/>);
      case "phishing": return wrap("üé£","card-icon-red","Phishing Detector","AI social engineering analysis",<PhishingDetector/>);
      case "cve": return wrap("üõ°Ô∏è","card-icon-amber","CVE Explainer","Plain-English vulnerability guide",<CVEExplainer/>);
      case "incident": return wrap("üö®","card-icon-red","Incident Response","Step-by-step recovery guide",
        <ChatTool systemPrompt="You are SENTINEL's Incident Response specialist. Help users who may have been hacked. Give clear numbered actionable steps. Be calm and specific. Plain text only." placeholder="Describe what happened‚Ä¶" starters={["I think my email was hacked","I clicked a suspicious link","Someone logged into my account","My computer is acting strange"]} emptyIcon="üö®" emptyTitle="Incident Response AI" emptyDesc="Describe what happened and I'll guide you step by step."/>);
      case "sentinel": return wrap("ü§ñ","card-icon-blue","SENTINEL AI","Your personal cyber expert",
        <ChatTool systemPrompt="You are SENTINEL, expert cybersecurity AI. Answer questions about threats, defenses, tools, best practices. Clear and educational. Never enable real attacks. Plain text." placeholder="Ask about any cybersecurity topic‚Ä¶" starters={["How does phishing work?","What is ransomware?","How do I secure my router?","What is a zero-day?","How do I know if I have malware?","Best free security tools?"]} emptyIcon="üõ°Ô∏è" emptyTitle="Ask SENTINEL anything" emptyDesc="Threats, attacks, defenses, best practices ‚Äî all covered."/>);
      case "tips": return (
        <div className="card"><div className="card-header"><div className="card-icon card-icon-green">üí°</div><div><div className="card-title">Security Best Practices</div><div className="card-desc">6 essential habits</div></div></div>
        <div className="card-body"><div className="tips-grid">{TIPS.map((t,i)=>(
          <div key={i} className="tip" style={{animationDelay:`${i*0.07}s`}}><div className="tip-emoji">{t.emoji}</div><div className="tip-title">{t.title}</div><div className="tip-body">{t.body}</div></div>
        ))}</div></div></div>
      );
      default: return null;
    }
  };

  return (
    <>
      <div className="bg-mesh"/>
      <div style={{display:"flex",width:"100%",height:"100vh",position:"relative",zIndex:1}}>
        <aside className="sidebar">
          <div className="sidebar-logo">
            <div className="logo-mark"><div className="logo-icon">üõ°Ô∏è</div><div className="logo-name">SENTINEL</div></div>
            <div className="logo-sub">CYBER DEFENSE v4.1</div>
          </div>
          <nav className="sidebar-nav">
            {sections.map(section=>(
              <div key={section}>
                <div className="nav-section-label">{section}</div>
                {NAV.filter(n=>n.section===section).map(n=>(
                  <div key={n.id} className={`nav-item ${page===n.id?"active":""}`} onClick={()=>setPage(n.id)}>
                    <div className="nav-icon">{n.icon}</div>
                    <span>{n.label}</span>
                    {n.badge&&<span className={`nav-badge ${n.id==="breach"||!hasVT()&&n.id==="url"?"":"live"}`}>{n.badge}</span>}
                  </div>
                ))}
              </div>
            ))}
          </nav>
          <div className="sidebar-footer">
            <div className="status-pill"><div className="pulse"/><span className="status-text" style={{color:"var(--teal)",fontSize:10,fontFamily:"'DM Mono',monospace"}}>Systems online</span></div>
          </div>
        </aside>
        <div className="main">
          <div className="topbar">
            <div><div className="topbar-title">{title}</div><div className="topbar-sub">{desc}</div></div>
            <div className="clock-badge"><Clock/></div>
          </div>
          <div className="content">{renderPage()}<div style={{height:28}}/></div>
        </div>
      </div>
    </>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
